<!DOCTYPE html>
<html>

<head>
    <title>Facial Expression Detection</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            var video = document.querySelector("#videoElement");

            if (navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then(function (stream) {
                        video.srcObject = stream;
                    })
                    .catch(function (err0r) {
                        console.log("Something went wrong!");
                    });
            }

            var canvas = document.querySelector("#canvasElement");
            var context = canvas.getContext('2d');
            var img = document.querySelector("#imgElement");

            function sendImageToServer() {
                context.drawImage(video, 0, 0, 640, 480);
                var dataURL = canvas.toDataURL('image/jpeg');
                $.ajax({
                    type: "POST",
                    url: "/predict",
                    data: {
                        image: dataURL
                    },
                    success: function (data) {
                        img.src = "data:image/jpeg;base64," + data;
                        setTimeout(sendImageToServer, 100);
                    }
                });
            }

            sendImageToServer();
        });
    </script>
</head>

<body>
    <h1>Facial Expression Detection</h1>
    <div>
        <video autoplay="true" id="videoElement" width="640" height="480"></video>
        <canvas id="canvasElement" width="640" height="480" style="display:none;"></canvas>
        <img id="imgElement" width="640" height="480" alt="Real-time expression" />
    </div>
</body>

</html>